<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>
  Crowdstrike&#39;s outage should not have happened, and the company is missing the point on how to avoid it in the future

    </title>
    
    <link rel="stylesheet" href="/css/main.min.b0ac2a435097757bc0f52ca79b98b87531ff99fa1b4c88d169395513962577d9.css" /><meta property="og:title" content="Crowdstrike&#39;s outage should not have happened, and the company is missing the point on how to avoid it in the future" />
<meta property="og:description" content="A global IT outage occurred on [2024-07-18 Thu], with several industries having significant economic problems (see Appendix 1: The impact for some quotes on what happened). The outage what caused by a bug in the remote update system of the software of Crowdstrike, a popular Threat Intelligence/Response company.
The company has published the Post Incident Review(Crowdstrike 2024a) right after the incident and has just released its root cause analysis (Crowdstrike 2024b)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ebellani.github.io/blog/2024/analyzing-crowdstrike-s-root-cause-analysis-or-on-missing-the-point-about-quality/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2024-08-07T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-08-07T00:00:00+00:00" />

</head>
  <body><nav>
  <img
    src="/img/triquetra.png"
    alt="put your logo here"
    width="128"
    height="128"
  />
  <h1>Eduardo&#39;s blog</h1>
  <ul>
    <li><a href="/">Home</a></li>
    <li><a href="/blog">Blog</a></li>
  </ul>
</nav>
<main>
  <h2>Crowdstrike&#39;s outage should not have happened, and the company is missing the point on how to avoid it in the future
    <small>
      <time>August 7, 2024</time>
    by Eduardo Bellani


    </small>
  </h2><p>A global IT outage occurred on <span class="timestamp-wrapper"><span class="timestamp">[2024-07-18 Thu]</span></span>, with several industries
having significant economic problems (see <a href="#crowdstrike-appendix-1">Appendix 1: The impact</a> for
some quotes on what happened). The outage what caused by a bug in the
remote update system of the software of Crowdstrike, a popular Threat
Intelligence/Response company.</p>
<p>The company has published the Post Incident
Review(<a href="#citeproc_bib_item_3">Crowdstrike 2024a</a>) right
after the incident and has just released its root cause analysis
(<a href="#citeproc_bib_item_4">Crowdstrike 2024b</a>). Reading them has
led me to write this article, specially the proposed mitigations.</p>
<p>According to the RCA, the essence of what happened was an index out of
bounds, which is a special case of a buffer overflow and considered an
<strong>undefined behavior in C++</strong>, the language that seems to be used to
develop crowdstrike&rsquo; system(<a href="#citeproc_bib_item_6">Stack 2024</a>).</p>
<p>Here then we get to the core of my argument: For a software of this
criticality, such problem should <strong>not be possible</strong>. The technology to
ensure such has existed for decades already, as can be seen in this
quote:</p>
<blockquote>
<p>&hellip; we can continue to add contracts to the code until every subprogram
has a fully functional specification. By this we mean that every
subprogram has a postcondition that specifies the value of each of its
outputs and a precondition as required to constrain the input
space. Further type invariants may also be added over and above those
already present from Gold level. Once the implementation has been
completed against this full specification and all VCs generated by the
analyzer have been proved, we have reached Platinum level of SPARK
assurance.</p>
<p>Due to the additional effort involved in developing the specification
and proof to this level, Platinum will only be appropriate for the most
critical applications. However, it is worth considering a reduction in
unit testing for functional verification if Platinum-level proof has
been achieved, since we *know that the program will return the correct
result for all inputs, not just for those we have been able to
test*. (<a href="#citeproc_bib_item_2">Chapman et al. 2024</a>)</p>
</blockquote>
<p>Furthermore, all the technical mitigations proposed in the RCA (see the
full list of problems found and their proposals in
<a href="#crowdstrike-appendix-2">Appendix 2:  What happened</a>) amount to just plugging holes. But safety
cannot be achieved in such way, safety needs to be designed into the
design, tools and languages used from the start of such endeavor.</p>
<p>If I were a client of Crowdstrike, I would be worried about the future.</p>
<h2 id="crowdstrike-appendix-1">Appendix 1: The impact</h2>
<blockquote>
<p>A major IT fault has hit services and infrastructure around the world,
with aviation, banking, healthcare and financial services among the
sectors affected.(<a href="#citeproc_bib_item_1">Banfield-Nwachi 2024</a>)</p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>The CrowdStrike outage didn&rsquo;t just delay flights and make it harder to
order coffee. It also affected doctor&rsquo;s offices and hospitals, 911
emergency services, hotel check-in and key card systems, and work-issued
computers that were online and grabbing updates when the flawed update
was sent out. In addition to providing fixes for client PCs and virtual
machines hosted in its Azure cloud, Microsoft says it has been working
with Google Cloud Platform, Amazon Web Services, and &ldquo;other cloud
providers and stakeholders&rdquo; to provide fixes to Windows VMs running in
its competitors&rsquo; clouds. (<a href="#citeproc_bib_item_5">Cunningham 2024</a>)</p>
</blockquote>
<!--quoteend-->
<blockquote>
<p>While software updates may occasionally cause disturbances, significant
incidents like the CrowdStrike event are infrequent. We currently
estimate that CrowdStrike’s update affected 8.5 million Windows devices,
or less than one percent of all Windows machines. While the percentage
was small, the broad economic and societal impacts reflect the use of
CrowdStrike by enterprises that run many critical services. (<a href="#citeproc_bib_item_7">Weston 2024</a>)</p>
</blockquote>
<h2 id="crowdstrike-appendix-2">Appendix 2:  What happened</h2>
<p>Here is the list of problems found and their mitigations proposed by
Crowdstrike&rsquo;s RCA(<a href="#citeproc_bib_item_4">Crowdstrike 2024b</a>)
(slightly reworded for space eficiency):</p>
<table>
<thead>
<tr>
<th>Finding</th>
<th>Mitigation</th>
</tr>
</thead>
<tbody>
<tr>
<td>The number of input fields .. not validated at sensor compile time</td>
<td>Validate the number of input fields at compile time</td>
</tr>
<tr>
<td>Missing runtime array bounds check</td>
<td>Add runtime input array bounds checks</td>
</tr>
<tr>
<td>Lack of variety in testing</td>
<td>Increase test coverage</td>
</tr>
<tr>
<td>Inconsistency between validator and interpreter</td>
<td>Fix the instance of inconsistency and add checks</td>
</tr>
<tr>
<td>No validation in the interpreter</td>
<td>Add tests</td>
</tr>
<tr>
<td>No staged deployment</td>
<td>Add staged deployment</td>
</tr>
</tbody>
</table>
<figure><img src="/ox-hugo/St%20Nedelya.jpg"
         alt="Figure 1: St Nedelya Church, partially destroyed in a terrorist attack by the Bulgarian Communist Party. 16 April 1925."/><figcaption>
            <p><span class="figure-number">Figure 1: </span>St Nedelya Church, partially destroyed in a terrorist attack by the Bulgarian Communist Party. 16 April 1925.</p>
        </figcaption>
</figure>

<h2 id="references">References</h2>
<style>.csl-entry{text-indent: -1.5em; margin-left: 1.5em;}</style><div class="csl-bib-body">
  <div class="csl-entry"><a id="citeproc_bib_item_1"></a>Banfield-Nwachi, Mabel. 2024. “Windows Global It Outage: What We Know so Far.” The Guardian. <a href="https://www.theguardian.com/technology/article/2024/jul/19/windows-global-it-outage-what-we-know-so-far">https://www.theguardian.com/technology/article/2024/jul/19/windows-global-it-outage-what-we-know-so-far</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_2"></a>Chapman, Roderick, Claire Dross, Stuart Matthews, and Yannick Moy. 2024. “Co-Developing Programs and Their Proof of Correctness.” <i>Commun. Acm</i> 67 (3): 84–94. <a href="https://doi.org/10.1145/3624728">https://doi.org/10.1145/3624728</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_3"></a>Crowdstrike. 2024a. “Crowdstrike Preliminary Post Incident Review (Pir): Content Configuration Update Impacting the Falcon Sensor and the Windows Operating System (Bsod).” Crowdstrike blog. <a href="https://www.crowdstrike.com/wp-content/uploads/2024/07/CrowdStrike-PIR-Executive-Summary.pdf">https://www.crowdstrike.com/wp-content/uploads/2024/07/CrowdStrike-PIR-Executive-Summary.pdf</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_4"></a>———. 2024b. “External Technical Root Cause Analysis — Channel File 291.” Crowdstrike blog. <a href="https://www.crowdstrike.com/wp-content/uploads/2024/08/Channel-File-291-Incident-Root-Cause-Analysis-08.06.2024.pdf">https://www.crowdstrike.com/wp-content/uploads/2024/08/Channel-File-291-Incident-Root-Cause-Analysis-08.06.2024.pdf</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_5"></a>Cunningham, Andrew. 2024. “Microsoft Says 8.5m Systems Hit by Crowdstrike Bsod, Releases Usb Recovery Tool.” Ars Technica. <a href="https://arstechnica.com/information-technology/2024/07/microsoft-says-8-5m-systems-hit-by-crowdstrike-bsod-releases-usb-recovery-tool/">https://arstechnica.com/information-technology/2024/07/microsoft-says-8-5m-systems-hit-by-crowdstrike-bsod-releases-usb-recovery-tool/</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_6"></a>Stack, The. 2024. “Crowdstrike Promises Rca as c++ Null Pointer Claim Contested.” The stack. <a href="https://www.thestack.technology/crowstrike-null-pointer-blamed-rca/">https://www.thestack.technology/crowstrike-null-pointer-blamed-rca/</a>.</div>
  <div class="csl-entry"><a id="citeproc_bib_item_7"></a>Weston, David. 2024. “Helping Our Customers through the Crowdstrike Outage.” Microsoft Official Blog. <a href="https://blogs.microsoft.com/blog/2024/07/20/helping-our-customers-through-the-crowdstrike-outage/">https://blogs.microsoft.com/blog/2024/07/20/helping-our-customers-through-the-crowdstrike-outage/</a>.</div>
</div>


   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   

   





<footer>
  <p>Feel free to send me an email: ebellani -at- gmail -dot- com</p>
  <p>
    Fingerprint: 48C50C6F1139C5160AA0DC2BC54D00BC4DF7CA7C
  </p>
</footer>

      </main>
    </main>
  </body>
</html>
